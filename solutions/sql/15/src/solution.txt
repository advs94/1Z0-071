1. CREATE TABLE dept2 (
     id NUMBER(7),
     name VARCHAR2(25)
   );
2. INSERT INTO dept2
   SELECT department_id,
          department_name
     FROM departments;
3. CREATE TABLE emp2 (
     id NUMBER(7),
     last_name VARCHAR2(25),
     first_name VARCHAR2(25),
     dept_id NUMBER(7)
   );
   DESC emp2;
4. ALTER TABLE emp2 ADD CONSTRAINT my_emp_id_pk PRIMARY KEY (id);
5. ALTER TABLE dept2 ADD CONSTRAINT my_dept_id_pk PRIMARY KEY (id);
6. ALTER TABLE emp2 ADD CONSTRAINT my_emp_dept_id_fk FOREIGN KEY (dept_id) REFERENCES dept2 (id);
7. ALTER TABLE emp2 ADD commision NUMBER(2,2) CONSTRAINT my_emp_comm_ck CHECK (commision > 0);
8. DROP TABLE emp2 PURGE;
   DROP TABLE dept2 PURGE;
9. a. CREATE OR REPLACE DIRECTORY emp_dir AS '/home/oracle/libs/sql2/emp_dir';
      GRANT READ ON DIRECTORY emp_dir TO teach_b;
      CREATE TABLE library_items_ext (
        category_id NUMBER(12),
        book_id NUMBER(6),
        book_price NUMBER(8,2),
        quantity NUMBER(8)
      )
      ORGANIZATION EXTERNAL (
        TYPE ORACLE_LOADER
        DEFAULT DIRECTORY emp_dir
        ACCESS PARAMETERS (RECORDS DELIMITED BY NEWLINE
                           FIELDS TERMINATED BY ',')
        LOCATION ('library_items.dat')
      )
      REJECT LIMIT UNLIMITED;
   b. SELECT *
        FROM library_items_ext;
10. a. N/A
    b. CREATE TABLE dept_add_ext (
         location_id,
         street_address,
         city,
         state_province,
         country_name
       )
       ORGANIZATION EXTERNAL (
         TYPE ORACLE_DATAPUMP
         DEFAULT DIRECTORY emp_dir
         LOCATION ('ora21_emp4.exp', 'ora21_emp5.exp')
       )
       PARALLEL AS
         SELECT location_id,
                street_address,
                city,
                state_province,
                country_name
           FROM locations
          NATURAL JOIN countries;
   c. SELECT *
        FROM dept_add_ext;
11. a. CREATE TABLE emp_books (
         book_id NUMBER,
         title VARCHAR2(20),
         CONSTRAINT emp_books_pk PRIMARY KEY (book_id) DEFERRABLE
       );
    b. INSERT INTO emp_books VALUES (300, 'Organizations');
       INSERT INTO emp_books VALUES (300, 'Change Management');
    c. SET CONSTRAINT emp_books_pk DEFERRED;
    d. DROP CONSTRAINT emp_books_pk;
    e. ALTER TABLE emp_books ADD CONSTRAINT emp_books_pk PRIMARY KEY (book_id) DEFERRABLE;
    f. SET CONSTRAINT emp_books_pk DEFERRED;
    g. INSERT INTO emp_books VALUES (300, 'Change Management');
       INSERT INTO emp_books VALUES (300, 'Personality');
       INSERT INTO emp_books VALUES (350, 'Creativity');
    h. COMMIT;